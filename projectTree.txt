# CHARLS Multiple Imputation Project Structure

```
CHARLS-Multiple-imputation-for-longitudinal-data/
│
├── README.md                           # Project overview and setup instructions
├── .gitignore                         # Git ignore file for R projects
│
├── R/                                 # Core R code files
│   ├── 01_diagnostics.R              # Environment validation functions
│   ├── 02_package_management.R       # Package installation and loading
│   ├── 03_optimized_imputation.R     # Main ImputationPipeline class
│   ├── 04_charls_specific.R          # CHARLS-specific configurations
│   ├── 05_debugging_tools.R          # Advanced debugging functions
│   ├── 06_performance_optimization.R # Memory and computation optimization
│   ├── 07_production_pipeline.R      # Production deployment script
│   └── 08_quick_start.R              # Quick start and setup functions
│
├── data/                              # Data directories
│   ├── raw/                          # Original data files
│   │   └── charlscm4.csv            # Your CHARLS dataset
│   ├── processed/                    # Cleaned and prepared data
│   │   └── charls_cleaned.rds       # Processed CHARLS data
│   ├── synthetic/                    # Test datasets
│   │   └── test_charls_data.csv     # Synthetic test data
│   └── backup/                       # Data backups
│
├── config/                           # Configuration files
│   ├── charls_variables.yaml        # CHARLS variable classifications
│   ├── production_config.yaml       # Production settings
│   ├── testing_config.yaml          # Testing/development settings
│   └── mcmc_parameters.yaml         # MCMC parameter configurations
│
├── outputs/                          # Analysis outputs
│   ├── models/                       # Fitted imputation models
│   │   ├── imputation_models.rds    # Saved model objects
│   │   └── model_diagnostics.rds    # Convergence diagnostics
│   ├── imputed_data/                 # Generated imputed datasets
│   │   ├── imputed_dataset_1.csv    # First imputed dataset
│   │   ├── imputed_dataset_2.csv    # Second imputed dataset
│   │   ├── ...                      # Additional imputed datasets
│   │   └── imputed_dataset_10.csv   # Tenth imputed dataset
│   ├── diagnostics/                  # Analysis diagnostics
│   │   ├── missing_analysis.rds     # Missing data patterns
│   │   ├── convergence_diagnostics.rds # MCMC convergence results
│   │   └── data_quality_report.rds  # Data validation results
│   └── reports/                      # Generated reports
│       ├── charls_analysis_report.json # Main analysis report (JSON)
│       ├── charls_analysis_report.rds  # Main analysis report (R)
│       ├── analysis_summary.txt     # Human-readable summary
│       └── technical_report.html    # Detailed technical report
│
├── tests/                            # Testing framework
│   ├── test_environment.R           # Environment setup tests
│   ├── test_data_processing.R       # Data processing tests
│   ├── test_imputation_models.R     # Model fitting tests
│   ├── test_convergence.R           # Convergence diagnostic tests
│   └── test_integration.R           # Full pipeline integration tests
│
├── logs/                             # Log files
│   ├── imputation.log              # Main processing log
│   ├── error.log                   # Error log
│   └── performance.log             # Performance monitoring log
│
├── docs/                            # Documentation
│   ├── CHARLS_data_dictionary.md   # CHARLS variable documentation
│   ├── methodology.md              # Statistical methodology notes
│   ├── troubleshooting.md          # Common issues and solutions
│   └── user_guide.md               # Step-by-step user guide
│
├── scripts/                         # Utility scripts
│   ├── run_full_analysis.R         # Complete analysis script
│   ├── run_quick_test.R            # Quick functionality test
│   ├── setup_environment.R        # Initial environment setup
│   └── generate_reports.R          # Report generation script
│
└── temp/                           # Temporary files (gitignored)
    ├── intermediate_data/          # Temporary processing files
    └── cache/                      # Cached computations
```

## File Descriptions

### Core R Files (`R/`)

**01_diagnostics.R**
- `check_environment()` - Validate R, JAGS, packages
- `quick_env_check()` - Fast environment validation
- `run_system_diagnostics()` - Comprehensive system check

**02_package_management.R**
- `install_all_packages()` - Install required packages safely
- `load_required_packages()` - Load packages with error handling
- `update_packages()` - Update to latest versions

**03_optimized_imputation.R**
- `ImputationPipeline` R6 class - Main pipeline
- Core methods: `load_data()`, `classify_variables()`, `fit_models()`
- Memory optimization and error handling

**04_charls_specific.R**
- `create_charls_pipeline()` - CHARLS-specific configuration
- Variable type definitions for CHARLS
- Data cleaning functions for CHARLS format

**05_debugging_tools.R**
- `debug_mcmc_convergence()` - MCMC diagnostic tools
- `debug_data_quality()` - Data validation functions
- `debug_model_specification()` - Model troubleshooting

**06_performance_optimization.R**
- `optimize_memory_usage()` - Memory management
- `optimize_computation()` - Performance tuning
- Parallel processing setup

**07_production_pipeline.R**
- `run_production_pipeline()` - Production deployment
- Logging and monitoring setup
- Configuration management

**08_quick_start.R**
- `run_complete_setup()` - One-command setup
- `run_immediate_test()` - Quick functionality test
- User-friendly wrapper functions

### Configuration Files (`config/`)

**charls_variables.yaml**
```yaml
binary_vars:
  - nation
  - marry
  - smoken
  # ... etc

ordinal_vars:
  - srh
  - satlife
  # ... etc

continuous_vars:
  - sleep
  - total_cognition
  # ... etc
```

**production_config.yaml**
```yaml
mcmc:
  n_chains: 3
  n_adapt: 300
  n_iter: 2000
  thin: 2

parallel:
  enabled: true
  max_workers: 6

output:
  n_imputations: 10
  save_diagnostics: true
```

### Key Output Files

**Imputed Datasets**: 10 complete datasets with missing values filled
**Models**: Fitted imputation model objects for reuse
**Reports**: Comprehensive analysis documentation
**Diagnostics**: Convergence and quality assessments

## Usage Workflow

1. **Setup**: Run setup functions to prepare environment
2. **Data**: Place CHARLS data in `data/raw/`
3. **Configure**: Modify `config/` files if needed
4. **Execute**: Run analysis scripts
5. **Results**: Find outputs in organized `outputs/` structure
6. **Reports**: Review generated reports and diagnostics

## Key Advantages of This Structure

- **Modular**: Each component is separate and testable
- **Scalable**: Easy to add new features or datasets
- **Reproducible**: Clear separation of code, data, and outputs
- **Production-Ready**: Logging, configuration, and error handling
- **User-Friendly**: Quick start options and comprehensive documentation
- **CHARLS-Optimized**: Specifically designed for longitudinal health data

This structure transforms the original single R Markdown file into a comprehensive, maintainable system for longitudinal multiple imputation analysis.